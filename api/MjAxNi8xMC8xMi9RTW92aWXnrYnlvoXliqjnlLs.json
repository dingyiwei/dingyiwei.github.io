{"title":"QMovie 等待动画","date":"2016-10-11T16:00:00.000Z","date_formatted":{"ll":"Oct 12, 2016","L":"10/12/2016","MM-DD":"10-12"},"thumbnail":"2016/10/12/QMovie等待动画/loading_bar.png","link":"2016/10/12/QMovie等待动画","tags":["Qt"],"updated":"2020-05-28T19:56:30.765Z","content":"<p>在 Qt 中，处理耗时操作可以使用 <code>QProcessBar</code>，但是有时出于某些考虑，希望能自定义一个等待动画。</p>\n<p>通过使用 <code>QMovie</code> 加载 gif 动图即可实现。</p>\n<figure class=\"highlight cpp\"><figcaption><span>loading.h</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">pragma</span> once</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;QWidget&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;QLabel&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;QMovie&gt;</span></span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Loading</span> :</span> <span class=\"keyword\">public</span> QWidget</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    Loading(QWidget *parent = <span class=\"literal\">nullptr</span>);</span><br><span class=\"line\">    ~Loading();</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">    QLabel *loadingLabel;</span><br><span class=\"line\">    QMovie *loadingMovie;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><figure class=\"highlight cpp\"><figcaption><span>loading.cpp</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"loading.h\"</span></span></span><br><span class=\"line\">Loading::Loading(QWidget *parent)</span><br><span class=\"line\">    :QWidget(parent)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    loadingLabel = <span class=\"keyword\">new</span> QLabel(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">    loadingMovie = <span class=\"keyword\">new</span> QMovie(<span class=\"string\">\"loading.gif\"</span>);</span><br><span class=\"line\">    loadingLabel-&gt;setMovie(loadingMovie);</span><br><span class=\"line\">    loadingMovie-&gt;start();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Loading::~Loading()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">delete</span> loadingMovie;</span><br><span class=\"line\">    <span class=\"keyword\">delete</span> loadingLabel;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><p>需要注意的是，gif 图片在 Qt 中无法改变大小，只能通过使用 Photoshop 或其他工具改变。</p>\n","prev":{"title":"编译原理课设总结","link":"2017/01/18/编译原理课设总结"},"next":{"title":"用 QtConcurrent 防止界面假死","link":"2016/10/10/用QtConcurrent防止界面假死"},"plink":"https://dingyiwei.github.io/2016/10/12/QMovie等待动画/"}